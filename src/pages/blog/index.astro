---
import { getCollection } from "astro:content";
import BlogCard from "../../components/BlogCard.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getReadingTime } from "../../utils/blog";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
);

const postsWithReadingTime = await Promise.all(
  posts.map(async (post) => {
    const { remarkPluginFrontmatter } = await post.render();
    return {
      ...post,
      readingTime: getReadingTime(post.body),
    };
  }),
);
---

<BaseLayout
  title="Abhishek Govindarasu - Blog"
  description="Technical writeups and articles about engineering, web exploitation, CTF challenges, and security research."
>
  <main class="flex-grow relative z-20">
    <section class="pt-24 pb-12 lg:pt-40 lg:pb-24 px-4 lg:px-8">
      <div class="max-w-7xl mx-auto">
        <div class="max-w-3xl">
          <h1
            class="text-4xl lg:text-7xl font-bold tracking-tight text-balance mb-4 lg:mb-6"
          >
            Technical Writings
          </h1>
          <p class="text-base lg:text-xl text-gray-400 leading-relaxed">
            Mostly CTF writeups and security research. Looking to write more about engineering and systems programming.
          </p>
        </div>
      </div>
    </section>

    <section class="pb-16 lg:pb-24 px-4 lg:px-8">
      <div class="max-w-7xl mx-auto">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-8">
          {
            postsWithReadingTime.map((post) => (
              <BlogCard post={post} readingTime={post.readingTime} />
            ))
          }
        </div>
      </div>
    </section>
  </main>
</BaseLayout>
